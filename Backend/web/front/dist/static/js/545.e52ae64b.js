"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[545],{2545:function(e,t,o){o.d(t,{Z:function(){return g}});var i=o(3396);const n={class:"page-topic"};function a(e,t,o,a,l,s){const c=(0,i.up)("single-topic"),r=(0,i.up)("van-list"),d=(0,i.up)("van-share-sheet");return(0,i.wg)(),(0,i.iD)("div",n,[(0,i.Wm)(r,{loading:e.loading,"onUpdate:loading":t[0]||(t[0]=t=>e.loading=t),finished:e.finished,"finished-text":"没有更多了",onLoad:e.getTopicList},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.topicList,(t=>((0,i.wg)(),(0,i.j4)(c,{key:t,topic:t,onShowShareCard:e.showShareCard},null,8,["topic","onShowShareCard"])))),128))])),_:1},8,["loading","finished","onLoad"]),(0,i.Wm)(d,{show:e.showShare,"onUpdate:show":t[1]||(t[1]=t=>e.showShare=t),title:"立即分享给好友",options:e.shareOptions,onSelect:e.onSelectShare},null,8,["show","options","onSelect"])])}var l=o(9089),s=o(4870),c=o(3300),r=o(7520),d=o(9733),u=o(5882),p=(0,i.aZ)({components:{SingleTopic:c.Z},props:{cid:{type:Number,required:!1},name:{type:String,required:!0}},setup(e){const t=(0,s.iH)(),o=(0,l.oR)(),n=(0,s.iH)(!1),a=(0,s.iH)(!1),c=(0,s.iH)(!1),p=(0,s.iH)(0),h=(0,i.Fl)((()=>o.getters["main/pageListData"](e.name))),m=(0,i.Fl)((()=>o.getters["main/pageListCount"](e.name))),v=()=>{let t={offset:h.value.length,limit:10};(0,r.bD)(`/topic/${e.cid}`,t).then((t=>{0===m.value||h.value.length<m.value?(o.commit(`main/changeTopic${e.name}Count`,t.data?.totalCount),o.commit(`main/pushTopic${e.name}List`,t.data?.list),a.value=!1,h.value?.length>=m.value&&(c.value=!0)):h.value.length===m.value&&(c.value=!0)}))},g=()=>{p.value=0,c.value=!1},f=e=>{(0,d.F)(e.name),n.value=!1;const o=document.createElement("input");document.body.appendChild(o),o.setAttribute("readonly","readonly"),o.setAttribute("value",`http://localhost:8080/topic/${t.value}`),o.select(),document.execCommand("copy"),document.body.removeChild(o)},y=e=>{n.value=!0,t.value=e};return{showShare:n,topicList:h,finished:c,loading:a,getTopicList:v,changeFinished:g,onSelectShare:f,shareOptions:u.c,showShareCard:y}}}),h=o(89);const m=(0,h.Z)(p,[["render",a],["__scopeId","data-v-a70a9ef0"]]);var v=m,g=v},5882:function(e,t,o){o.d(t,{c:function(){return i}});const i=[{name:"复制链接",icon:"link"}]},3300:function(e,t,o){o.d(t,{Z:function(){return S}});var i=o(3396),n=o(9242),a=o(7139);const l=e=>((0,i.dD)("data-v-69c05f5d"),e=e(),(0,i.Cn)(),e),s={class:"topic-title"},c={class:"topic-intro van-multi-ellipsis--l2"},r=l((()=>(0,i._)("p",{class:"yes-ratio"},"Yes",-1))),d=l((()=>(0,i._)("p",{class:"no-ratio"},"No",-1)));function u(e,t,o,l,u,p){const h=(0,i.up)("van-loading"),m=(0,i.up)("van-image"),v=(0,i.up)("van-icon"),g=(0,i.up)("van-progress"),f=(0,i.up)("van-divider");return(0,i.wg)(),(0,i.iD)("div",{class:"single-topic",onClick:t[1]||(t[1]=t=>e.handleTopicClick(e.topic?.tid))},[(0,i.Wm)(m,{src:e.topic?.img_url,fit:"cover","lazy-load":"",alt:e.topic?.title,radius:"10px"},{loading:(0,i.w5)((()=>[(0,i.Wm)(h,{type:"spinner",size:"20"})])),error:(0,i.w5)((()=>[(0,i.Uk)("error")])),_:1},8,["src","alt"]),(0,i.Wm)(v,{name:"star",class:"icon-star",size:"2rem",color:!0===e.isCollect?"#fbff25":"#838383",onClick:(0,n.iM)(e.handleCollectClick,["stop"])},null,8,["color","onClick"]),(0,i._)("p",s,(0,a.zw)(e.topic?.title),1),(0,i._)("h4",c,(0,a.zw)(e.topic?.intro),1),r,d,(0,i.Wm)(g,{percentage:e.topic?.yes_ratio,"stroke-width":"16",color:"#61D089","pivot-color":e.topic?.yes_ratio<=50?"#f2a4a4":"#61D089"},null,8,["percentage","pivot-color"]),(0,i._)("div",null,[(0,i.Wm)(v,{name:"points",class:"icon-points",size:"1rem"},{default:(0,i.w5)((()=>[(0,i._)("span",null,(0,a.zw)(e.topic?.total_price),1)])),_:1}),(0,i.Wm)(v,{name:"guide-o",class:"icon-guide",size:"1rem",onClick:t[0]||(t[0]=(0,n.iM)((t=>e.handleShareClick(e.topic?.tid)),["stop"]))})]),(0,i.Wm)(f)])}o(7658);var p=o(7520),h=o(4870),m=o(2483),v=o(9089),g=o(9733),f=o(5882),y=(0,i.aZ)({props:{topic:{type:Object,required:!1}},emits:["showShareCard"],setup(e,{emit:t}){const o=(0,h.iH)(!1),i=(0,m.tv)(),n=(0,v.oR)(),a=(0,m.yj)(),l=n.state.login.userInfo,s=async()=>{if(n.state.login.userInfo.mixin_uuid){const t=await(0,p.oj)("/collect/check",{user_id:n.state.login.userInfo.mixin_uuid,tid:e.topic?.tid});null!==t.data&&(o.value=!0)}};s();const c=async()=>{if(l.mixin_uuid){if(!0===o.value){const t=await(0,p.oj)("/collect/delete",{user_id:n.state.login.userInfo.mixin_uuid,tid:e.topic?.tid});null!==t.data&&(o.value=!1),(0,g.F)("删除收藏!!!")}else{const t=await(0,p.oj)("/collect/add",{user_id:n.state.login.userInfo.mixin_uuid,tid:e.topic?.tid});null===t.data&&(o.value=!0),(0,g.F)("收藏成功!!!")}n.dispatch("main/handleCollecTopictAction")}else n.dispatch("login/accountLoginAction",a.path)},r=e=>{i.push(`/topic/${e}`)},d=e=>{console.log("handleShareClick"),t("showShareCard",e)};return{shareOptions:f.c,isCollect:o,handleCollectClick:c,handleTopicClick:r,handleShareClick:d}}}),C=o(89);const w=(0,C.Z)(y,[["render",u],["__scopeId","data-v-69c05f5d"]]);var S=w},9733:function(e,t,o){o.d(t,{F:function(){return z}});o(7658);var i=o(3396),n=o(4870),a=o(2220),l=o(6491),s=o(1404),c=o(7548),r=o(610),d=o(5323);let u=0;function p(e){e?(u||document.body.classList.add("van-toast--unclickable"),u++):u&&(u--,u||document.body.classList.remove("van-toast--unclickable"))}var h=o(3649),m=o(6305),v=o(2229);const[g,f]=(0,r["do"])("toast"),y=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay"],C={icon:String,show:Boolean,type:(0,d.SQ)("text"),overlay:Boolean,message:d.Or,iconSize:d.Or,duration:(0,d.qM)(2e3),position:(0,d.SQ)("middle"),teleport:[String,Object],className:d.Vg,iconPrefix:String,transition:(0,d.SQ)("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:d.Vg,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var w=(0,i.aZ)({name:g,props:C,emits:["update:show"],setup(e,{emit:t}){let o,n=!1;const s=()=>{const t=e.show&&e.forbidClick;n!==t&&(n=t,p(n))},c=e=>t("update:show",e),r=()=>{e.closeOnClick&&c(!1)},d=()=>clearTimeout(o),u=()=>{const{icon:t,type:o,iconSize:n,iconPrefix:a,loadingType:l}=e,s=t||"success"===o||"fail"===o;return s?(0,i.Wm)(h.J,{name:t||o,size:n,class:f("icon"),classPrefix:a},null):"loading"===o?(0,i.Wm)(v.g,{class:f("loading"),size:n,type:l},null):void 0},g=()=>{const{type:t,message:o}=e;if((0,l.Xq)(o)&&""!==o)return"html"===t?(0,i.Wm)("div",{key:0,class:f("text"),innerHTML:String(o)},null):(0,i.Wm)("div",{class:f("text")},[o])};return(0,i.YP)((()=>[e.show,e.forbidClick]),s),(0,i.YP)((()=>[e.show,e.type,e.message,e.duration]),(()=>{d(),e.show&&e.duration>0&&(o=setTimeout((()=>{c(!1)}),e.duration))})),(0,i.bv)(s),(0,i.Ah)(s),()=>(0,i.Wm)(m.G,(0,i.dG)({class:[f([e.position,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:r,onClosed:d,"onUpdate:show":c},(0,a.ei)(e,y)),{default:()=>[u(),g()]})}});const S={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let k=[],_=!1,b=(0,a.l7)({},S);const O=new Map;function x(e){return(0,l.Kn)(e)?e:{message:e}}function W(){const{instance:e,unmount:t}=(0,c.H)({setup(){const o=(0,n.iH)(""),{open:a,state:l,close:s,toggle:r}=(0,c.o)(),d=()=>{_&&(k=k.filter((t=>t!==e)),t())},u=()=>{const e={onClosed:d,"onUpdate:show":r};return(0,i.Wm)(w,(0,i.dG)(l,e),null)};return(0,i.YP)(o,(e=>{l.message=e})),(0,i.FN)().render=u,{open:a,clear:s,message:o}}});return e}function T(){if(!k.length||_){const e=W();k.push(e)}return k[k.length-1]}function z(e={}){if(!a._f)return{};const t=T(),o=x(e);return t.open((0,a.l7)({},b,O.get(o.type||b.type),o)),t}const L=e=>t=>z((0,a.l7)({type:e},x(t)));function D(e,t){"string"===typeof e?O.set(e,t):(0,a.l7)(b,e)}z.loading=L("loading"),z.success=L("success"),z.fail=L("fail"),z.clear=e=>{var t;k.length&&(e?(k.forEach((e=>{e.clear()})),k=[]):_?null==(t=k.shift())||t.clear():k[0].clear())},z.setDefaultOptions=D,z.resetDefaultOptions=e=>{"string"===typeof e?O.delete(e):(b=(0,a.l7)({},S),O.clear())},z.allowMultiple=(e=!0)=>{_=e},z.install=e=>{e.use((0,s.n)(w)),e.config.globalProperties.$toast=z}}}]);
//# sourceMappingURL=545.e52ae64b.js.map